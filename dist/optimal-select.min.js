!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.OptimalSelect=t():e.OptimalSelect=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.common=t.optimize=t.getMultiSelector=t.getSingleSelector=t.select=void 0;var u=n(6);Object.defineProperty(t,"getSingleSelector",{enumerable:!0,get:function(){return u.getSingleSelector}}),Object.defineProperty(t,"getMultiSelector",{enumerable:!0,get:function(){return u.getMultiSelector}});var i=o(u),a=n(4),c=o(a),l=n(3),f=r(l);t.select=i.default,t.optimize=c.default,t.common=f,t.default=i.default},function(e,t){"use strict";function n(e){for(var t=e.length,n=new Array(t),r=0;r<t;r++)n[r]=e[r];return n}function r(e){return e&&e.replace(/['"`\\/:\?&!#$%^()[\]{|}*+;,.<=>@~]/g,"\\$&")}Object.defineProperty(t,"__esModule",{value:!0}),t.convertNodeList=n,t.escapeValue=r},function(e,t){(function(n){"use strict";function r(e,t){if(n.document)return!1;var r=t.context;n.document=r||function(){for(var t=e;t.parent;)t=t.parent;return t}();var i=Object.getPrototypeOf(n.document);return Object.getOwnPropertyDescriptor(i,"childTags")||Object.defineProperty(i,"childTags",{enumerable:!0,get:function(){return this.children.filter(function(e){return"tag"===e.type||"script"===e.type||"style"===e.type})}}),Object.getOwnPropertyDescriptor(i,"attributes")||Object.defineProperty(i,"attributes",{enumerable:!0,get:function(){var e=this.attribs,t=Object.keys(e),n=t.reduce(function(t,n,r){return t[r]={name:n,value:e[n]},t},{});return Object.defineProperty(n,"length",{enumerable:!1,configurable:!1,value:t.length}),n}}),i.getAttribute||(i.getAttribute=function(e){return this.attribs[e]||null}),i.getElementsByTagName||(i.getElementsByTagName=function(e){var t=[];return u(this.childTags,function(n){n.name!==e&&"*"!==e||t.push(n)}),t}),i.getElementsByClassName||(i.getElementsByClassName=function(e){var t=e.trim().replace(/\s+/g," ").split(" "),n=[];return u([this],function(e){var r=e.attribs.class;r&&t.every(function(e){return r.indexOf(e)>-1})&&n.push(e)}),n}),i.querySelectorAll||(i.querySelectorAll=function(e){var t=this;e=e.replace(/(>)(\S)/g,"$1 $2").trim();var n=o(e),r=n.shift(),u=n.length;return r(this).filter(function(e){for(var r=0;r<u;){if(e=n[r](e,t),!e)return!1;r+=1}return!0})}),i.contains||(i.contains=function(e){var t=!1;return u([this],function(n,r){n===e&&(t=!0,r())}),t}),!0}function o(e){return e.split(" ").reverse().map(function(e,t){var n=0===t,r=e.split(":"),o=c(r,2),l=o[0],f=o[1],s=null,d=null;if(function(){switch(!0){case/>/.test(l):d=function(e){return function(t){return t(e.parent)&&e.parent}};break;case/^\./.test(l):var e=l.substr(1).split(".");s=function(t){var n=t.attribs.class;return n&&e.every(function(e){return n.indexOf(e)>-1})},d=function(t,r){return n?t.getElementsByClassName(e.join(" ")):"function"==typeof t?t(s):i(t,r,s)};break;case/^\[/.test(l):var t=l.replace(/\[|\]|"/g,"").split("="),r=c(t,2),o=r[0],f=r[1];s=function(e){var t=Object.keys(e.attribs).indexOf(o)>-1;return!(!t||f&&e.attribs[o]!==f)},d=function(e,t){if(n){var r=function(){var t=[];return u([e],function(e){s(e)&&t.push(e)}),{v:t}}();if("object"===("undefined"==typeof r?"undefined":a(r)))return r.v}return"function"==typeof e?e(s):i(e,t,s)};break;case/^#/.test(l):var p=l.substr(1);s=function(e){return e.attribs.id===p},d=function(e,t){if(n){var r=function(){var t=[];return u([e],function(e,n){s(e)&&(t.push(e),n())}),{v:t}}();if("object"===("undefined"==typeof r?"undefined":a(r)))return r.v}return"function"==typeof e?e(s):i(e,t,s)};break;case/\*/.test(l):s=function(e){return!0},d=function(e,t){if(n){var r=function(){var t=[];return u([e],function(e){return t.push(e)}),{v:t}}();if("object"===("undefined"==typeof r?"undefined":a(r)))return r.v}return"function"==typeof e?e(s):i(e,t,s)};break;default:s=function(e){return e.name===l},d=function(e,t){if(n){var r=function(){var t=[];return u([e],function(e){s(e)&&t.push(e)}),{v:t}}();if("object"===("undefined"==typeof r?"undefined":a(r)))return r.v}return"function"==typeof e?e(s):i(e,t,s)}}}(),!f)return d;var p=f.match(/-(child|type)\((\d+)\)$/),v=p[1],g=parseInt(p[2],10)-1,m=function(e){if(e){var t=e.parent.childTags;"type"===v&&(t=t.filter(s));var n=t.findIndex(function(t){return t===e});if(n===g)return!0}return!1};return function(e){var t=d(e);return n?t.reduce(function(e,t){return m(t)&&e.push(t),e},[]):m(t)&&t}})}function u(e,t){e.forEach(function(e){var n=!0;t(e,function(){return n=!1}),e.childTags&&n&&u(e.childTags,t)})}function i(e,t,n){for(;e.parent;){if(e=e.parent,n(e))return e;if(e===t)break}return null}Object.defineProperty(t,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=function(){function e(e,t){var n=[],r=!0,o=!1,u=void 0;try{for(var i,a=e[Symbol.iterator]();!(r=(i=a.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,u=e}finally{try{!r&&a.return&&a.return()}finally{if(o)throw u}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.default=r,e.exports=t.default}).call(t,function(){return this}())},function(e,t){"use strict";function n(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.root,r=void 0===n?document:n,o=(t.skip,t.ignore,[]);e.forEach(function(e,t){for(var n=[];e!==r;)e=e.parentNode,n.unshift(e);o[t]=n}),o.sort(function(e,t){return e.length-t.length});for(var u=o.shift(),i=null,a=function(){var e=u[c],t=o.some(function(t){return!t.some(function(t){return t===e})});return t?"break":void(i=e)},c=0,l=u.length;c<l;c++){var f=a();if("break"===f)break}return i}function r(e){var t={classes:[],attributes:{},tag:null};return e.forEach(function(e){var n=t.classes,r=t.attributes,o=t.tag;if(void 0!==n){var u=e.getAttribute("class");u?(u=u.trim().split(" "),n.length?(n=n.filter(function(e){return u.some(function(t){return t===e})}),n.length?t.classes=n:delete t.classes):t.classes=u):delete t.classes}if(void 0!==r&&!function(){var n=e.attributes,o=Object.keys(n).reduce(function(e,t){var r=n[t],o=r.name;return r&&"class"!==o&&(e[o]=r.value),e},{}),u=Object.keys(o),i=Object.keys(r);u.length?i.length?(r=i.reduce(function(e,t){var n=r[t];return n===o[t]&&(e[t]=n),e},{}),Object.keys(r).length?t.attributes=r:delete t.attributes):t.attributes=o:delete t.attributes}(),void 0!==o){var i=e.tagName.toLowerCase();o?i!==o&&delete t.tag:t.tag=i}}),t}Object.defineProperty(t,"__esModule",{value:!0}),t.getCommonAncestor=n,t.getCommonProperties=r},function(e,t,n){(function(r){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function u(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(console.log(" OptimalSelect  ",e,n),console.trace(),Array.isArray(t)||(t=t.length?(0,f.convertNodeList)(t):[t]),!t.length||t.some(function(e){return 1!==e.nodeType}))throw new Error('Invalid input - to compare HTMLElements its necessary to provide a reference of the selected node(s)! (missing "elements")');var o=(0,l.default)(t[0],n),u=e.replace(/> /g,">").split(/\s+(?=(?:(?:[^"]*"){2})*[^"]*$)/);if(u.length<2)return i("",e,"",t);for(var a=[u.pop()];u.length>1;){var c=u.pop(),s=u.join(" "),d=a.join(" "),p=s+" "+d,v=document.querySelectorAll(p);v.length!==t.length&&a.unshift(i(s,c,d,t))}return a.unshift(u[0]),u=a,u[0]=i("",u[0],u.slice(1).join(" "),t),u[u.length-1]=i(u.slice(0,-1).join(" "),u[u.length-1],"",t),o&&delete r.document,u.join(" ").replace(/>/g,"> ").trim()}function i(e,t,n,r){if(e.length&&(e+=" "),n.length&&(n=" "+n),/\[*\]/.test(t)){var o=t.replace(/=.*$/,"]"),u=""+e+o+n,i=document.querySelectorAll(u);if(a(i,r))t=o;else for(var c=document.querySelectorAll(""+e+o),l=function(){var o=c[f];if(r.some(function(e){return o.contains(e)})){var l=o.tagName.toLowerCase();return u=""+e+l+n,i=document.querySelectorAll(u),a(i,r)&&(t=l),"break"}},f=0,s=c.length;f<s;f++){var u,i,d=l();if("break"===d)break}}if(/>/.test(t)){var p=t.replace(/>/,""),u=""+e+p+n,i=document.querySelectorAll(u);a(i,r)&&(t=p)}if(/:nth-child/.test(t)){var v=t.replace(/nth-child/g,"nth-of-type"),u=""+e+v+n,i=document.querySelectorAll(u);a(i,r)&&(t=v)}if(/\.\S+\.\S+/.test(t)){for(var g=t.trim().split(".").slice(1).map(function(e){return"."+e}).sort(function(e,t){return e.length-t.length});g.length;){var m=t.replace(g.shift(),"").trim(),u=(""+e+m+n).trim();if(!u.length||">"===u.charAt(0))break;var i=document.querySelectorAll(u);a(i,r)&&(t=m)}if(t&&t.match(/\./g).length>2)for(var y=document.querySelectorAll(""+e+t),h=function(){var o=y[f];if(r.some(function(e){return o.contains(e)})){var c=o.tagName.toLowerCase();return u=""+e+c+n,i=document.querySelectorAll(u),a(i,r)&&(t=c),"break"}},f=0,s=y.length;f<s;f++){var u,i,b=h();if("break"===b)break}}return t}function a(e,t){var n=e.length;return n===t.length&&t.every(function(t){for(var r=0;r<n;r++)if(e[r]===t)return!0;return!1})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=u;var c=n(2),l=o(c),f=n(1);e.exports=t.default}).call(t,function(){return this}())},function(e,t,n){"use strict";function r(e,t){var n=t.root,r=void 0===n?document:n,v=t.skip,g=void 0===v?null:v,m=t.priority,y=void 0===m?["id","class","href","src"]:m,h=t.ignore,b=void 0===h?{}:h,j=[],O=e,k=j.length,A=g&&(Array.isArray(g)?g:[g]).map(function(e){return"function"!=typeof e?function(t){return t===e}:e}),N=function(e){return g&&A.some(function(t){return t(e)})},x=!1;for(Object.keys(b).forEach(function(e){"class"===e&&(x=!0);var t=b[e];"function"!=typeof t&&("number"==typeof t&&(t=t.toString()),"string"==typeof t&&(t=new RegExp((0,S.escapeValue)(t).replace(/\\/g,"\\\\"))),b[e]=t.test.bind(t))}),x&&!function(){var e=b.attribute;b.attribute=function(t,n,r){return b.class(n)||e&&e(t,n,r)}}();O!==r;){if(N(O)!==!0){if(p(O,j,b))break;if(o(O,j,b,r))break;if(a(O,j,b,r,y))break;if(f(O,j,b,r))break;u(O,j,b),j.length===k&&c(O,j,b,y),j.length===k&&s(O,j,b),j.length===k&&i(O,j,b),j.length===k&&l(O,j,b,y),j.length===k&&d(O,j,b)}O=O.parentNode,k=j.length}return O===r&&j.unshift("*"),j.join(" ")}function o(e,t,n,r){return v(e,t,n,r)}function u(e,t,n){return v(e,t,n,e.parentNode)}function i(e,t,n){var r=(0,S.escapeValue)(e.getAttribute("class"));return!h(n.class,r)&&y(e,t,"."+r.trim().replace(/\s+/g,"."))}function a(e,t,n,r,o){return g(e,t,n,r,o)}function c(e,t,n,r){return g(e,t,n,e.parentNode,r)}function l(e,t,n,r){var o=e.attributes;return Object.keys(o).sort(b(o,r)).some(function(r){var u=o[r],i=u.name,a=(0,S.escapeValue)(u.value);if(h(n.attribute,i,a,j.attribute))return!1;var c="["+i+'="'+a+'"]';return y(e,t,c)})}function f(e,t,n,r){return m(e,t,n,r)}function s(e,t,n){return m(e,t,n,e.parentNode)}function d(e,t,n){var r=e.tagName.toLowerCase();return!h(n.tag,r)&&y(e,t,r)}function p(e,t,n){var r=(0,S.escapeValue)(e.getAttribute("id"));return!h(n.id,r)&&(t.unshift("#"+r),!0)}function v(e,t,n,r){var o=(0,S.escapeValue)(e.getAttribute("class"));if(h(n.class,o))return!1;if(e.classList.length>0)for(var u=e.classList,i=0;i<u.length;i++)if(1==r.getElementsByClassName(u[i]).length){o=u[i];break}var a=r.getElementsByClassName(o);return 1===a.length&&(t.unshift("."+o.trim().replace(/\s+/g,".")),!0)}function g(e,t,n,r,o){var u=e.attributes;return Object.keys(u).sort(b(u,o)).some(function(e){var o=u[e],i=o.name,a=(0,S.escapeValue)(o.value);if(h(n.attribute,i,a,j.attribute))return!1;var c="["+i+'="'+a+'"]',l=r.querySelectorAll(c);return 1===l.length?(t.unshift(c),!0):void 0})}function m(e,t,n,r){var o=e.tagName.toLowerCase();if(h(n.tag,o))return!1;var u=r.getElementsByTagName(o);return 1===u.length&&(t.unshift(o),!0)}function y(e,t,n){for(var r=e.parentNode,o=r.childTags||r.children,u=0,i=o.length;u<i;u++)if(o[u]===e)return t.unshift("> "+n+":nth-child("+(u+1)+")"),!0;return!1}function h(e,t,n,r){if(!t)return!0;var o=e||r;return!!o&&o(t,n||t,r)}function b(e,t){return function(n,r){return t.indexOf(e[n].name)-t.indexOf(e[r].name)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var S=n(1),j={attribute:function(e){return["style","data-reactid","data-react-checksum"].indexOf(e)>-1}};e.exports=t.default},function(e,t,n){(function(e){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return console.log("OptimalSelect getQuerySelector is here ",arguments),e.length?i(e,t):u(e,t)}function u(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(3===t.nodeType&&(t=t.parentNode),1!==t.nodeType)throw new Error('Invalid input - only HTMLElements or representations of them are supported! (not "'+("undefined"==typeof t?"undefined":c(t))+'")');var r=(0,f.default)(t,n),o=(0,d.default)(t,n);console.log(" getSingleSelector 0",o,n);var u=(0,v.default)(o,t,n);return console.log(" getSingleSelector 1 ",o,u),r&&delete e.document,u}function i(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(console.log(" csk8855 getMultiSelector "),Array.isArray(t)||(t=(0,g.convertNodeList)(t)),t.some(function(e){return 1!==e.nodeType}))throw new Error("Invalid input - only an Array of HTMLElements or representations of them is supported!");var r=(0,f.default)(t[0],n),o=(0,m.getCommonAncestor)(t,n),i=u(o,n),c=a(t),l=c[0],s=(0,v.default)(i+" "+l,t,n),d=(0,g.convertNodeList)(document.querySelectorAll(s));return t.every(function(e){return d.some(function(t){return t===e})})?(r&&delete e.document,s):console.warn("\n      The selected elements can't be efficiently mapped.\n      Its probably best to use multiple single selectors instead!\n    ",t)}function a(e){console.log("csk8855 getCommonSelectors ",e);var t=(0,m.getCommonProperties)(e),n=t.classes,r=t.attributes,o=t.tag,u=[];if(o&&u.push(o),n){var i=n.map(function(e){return"."+e}).join("");console.log("classSelector on optString ",i),u.push(i)}if(r){var a=Object.keys(r).reduce(function(e,t){return e.push("["+t+'="'+r[t]+'"]'),e},[]).join("");u.push(a)}return u.length,[u.join("")]}Object.defineProperty(t,"__esModule",{value:!0});var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.default=o,t.getSingleSelector=u,t.getMultiSelector=i;var l=n(2),f=r(l),s=n(5),d=r(s),p=n(4),v=r(p),g=n(1),m=n(3)}).call(t,function(){return this}())}])});
//# sourceMappingURL=optimal-select.min.js.map